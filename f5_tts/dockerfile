# 1) Partir de la imagen base de PyTorch con CUDA
FROM pytorch/pytorch:2.4.0-cuda12.4-cudnn9-devel

# 2) Usar el usuario root (para instalar paquetes sin restricciones)
USER root

# 3) Configurar algunos argumentos y variables
ARG DEBIAN_FRONTEND=noninteractive
ENV SHELL=/bin/bash

# 4) Etiqueta opcional para tu contenedor
LABEL maintainer="TuNombre <josueflorian12317@gmail.com>"
LABEL description="Spanish-F5 (fine-tuned F5-TTS with Peruvian accent)"

# 5) Instalar dependencias del sistema
RUN apt-get update && apt-get install -y \
    wget curl man git less openssl libssl-dev unzip unar build-essential \
    aria2 tmux vim \
    sox libsox-fmt-all libsox-fmt-mp3 libsndfile1-dev ffmpeg \
    && rm -rf /var/lib/apt/lists/* \
    && apt-get clean

# 6) Crear el directorio de trabajo
WORKDIR /workspace/Spanish-F5

# 7) Copiar el contenido de tu repositorio local al contenedor
#    (Asumiendo que el Dockerfile está en la raíz de tu repo local)
COPY . .

# 8) Instalar librerías de Python (dependerá de tu proyecto)
#    Aquí puedes instalar con "pip install -e .[eval]" si tienes configurado setup.py
#    o un requirements.txt con todas las dependencias necesarias.
RUN pip install --upgrade pip
RUN pip install -r requirements.txt

# 9) Comando por defecto al arrancar el contenedor
#    Podrías cambiarlo a un script concreto o simplemente abrir bash
CMD ["/bin/bash"]
